<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Primal-Dual 1D Widget</title>
  <style>
    body{margin:0;font-family:system-ui;background:#0b0d12;color:#e9eefc}
    .wrap{max-width:1000px;margin:20px auto;padding:0 14px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .card{background:#111626;border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:12px}
    canvas{width:100%;height:auto;display:block;border-radius:10px;background:#0a0f1f}
    label{display:block;margin-top:10px;color:#aab3c8}
    input{width:100%}
    .mono{font-family:ui-monospace,Menlo,Consolas,monospace}
  </style>
</head>
<body>
<div class="wrap">
  <h2>Primal vs Dual Function (1D Example)</h2>
  <div class="card">
    <div class="mono">
      Primal: min (x-2)² s.t. x ≤ 1.<br/>
      Dual g(λ) = λ - λ²/4 (max at λ*=2).
    </div>
    <label>Select λ:</label>
    <input id="lam" type="range" min="0" max="4" step="0.01" value="1.0">
    <div class="grid" style="margin-top:10px">
      <div class="card">
        <canvas id="c1" width="800" height="400"></canvas>
        <div class="mono" id="inf1"></div>
      </div>
      <div class="card">
        <canvas id="c2" width="800" height="400"></canvas>
        <div class="mono" id="inf2"></div>
      </div>
    </div>
  </div>
</div>
<script>
(() => {
  const lamS=document.getElementById("lam");
  const c1=document.getElementById("c1"), ctx1=c1.getContext("2d");
  const c2=document.getElementById("c2"), ctx2=c2.getContext("2d");
  const i1=document.getElementById("inf1"), i2=document.getElementById("inf2");

  function f0(x){ return (x-2)**2; }
  function g(l){ return l - (l*l)/4; }
  function L(x,l){ return (x-2)**2 + l*(x-1); }

  function map(v,a,b,A,B){ return A+(v-a)*(B-A)/(b-a); }

  function render(){
    const l = parseFloat(lamS.value);

    // Plot 1: Primal + Lagrangian
    ctx1.clearRect(0,0,c1.width,c1.height);
    const xMin=-1, xMax=3, yMin=-1, yMax=5;
    const mx = x => map(x,xMin,xMax, 40, c1.width-20);
    const my = y => map(y,yMin,yMax, c1.height-30, 20);

    // axes
    ctx1.strokeStyle="rgba(255,255,255,0.2)";
    ctx1.beginPath(); ctx1.moveTo(mx(xMin),my(0)); ctx1.lineTo(mx(xMax),my(0)); ctx1.stroke();
    ctx1.beginPath(); ctx1.moveTo(mx(0),my(yMin)); ctx1.lineTo(mx(0),my(yMax)); ctx1.stroke();

    // f0
    ctx1.strokeStyle="rgba(100,150,255,0.8)"; ctx1.lineWidth=2;
    ctx1.beginPath();
    for(let i=0;i<100;i++){
       let x=xMin+(xMax-xMin)*i/99;
       let y=f0(x);
       if(i==0) ctx1.moveTo(mx(x),my(y)); else ctx1.lineTo(mx(x),my(y));
    }
    ctx1.stroke();

    // L
    ctx1.strokeStyle="rgba(255,100,100,0.8)";
    ctx1.beginPath();
    for(let i=0;i<100;i++){
       let x=xMin+(xMax-xMin)*i/99;
       let y=L(x,l);
       if(i==0) ctx1.moveTo(mx(x),my(y)); else ctx1.lineTo(mx(x),my(y));
    }
    ctx1.stroke();

    // min of L
    let xstar = 2 - l/2;
    let ystar = L(xstar,l);
    ctx1.fillStyle="white"; ctx1.beginPath(); ctx1.arc(mx(xstar),my(ystar),4,0,6.28); ctx1.fill();

    i1.innerHTML = `L(x,${l.toFixed(2)}) min at x=${xstar.toFixed(2)}, val=${ystar.toFixed(2)}`;

    // Plot 2: Dual Function
    ctx2.clearRect(0,0,c2.width,c2.height);
    const lMin=0, lMax=4, gMin=-1, gMax=1.5;
    const ml = x => map(x,lMin,lMax, 40, c2.width-20);
    const mg = y => map(y,gMin,gMax, c2.height-30, 20);

    // axes
    ctx2.strokeStyle="rgba(255,255,255,0.2)";
    ctx2.beginPath(); ctx2.moveTo(ml(lMin),mg(0)); ctx2.lineTo(ml(lMax),mg(0)); ctx2.stroke();
    ctx2.beginPath(); ctx2.moveTo(ml(0),mg(gMin)); ctx2.lineTo(ml(0),mg(gMax)); ctx2.stroke();

    ctx2.strokeStyle="rgba(150,255,150,0.8)"; ctx2.lineWidth=2;
    ctx2.beginPath();
    for(let i=0;i<100;i++){
       let lam=lMin+(lMax-lMin)*i/99;
       let y=g(lam);
       if(i==0) ctx2.moveTo(ml(lam),mg(y)); else ctx2.lineTo(ml(lam),mg(y));
    }
    ctx2.stroke();

    // current point
    ctx2.fillStyle="white"; ctx2.beginPath(); ctx2.arc(ml(l),mg(g(l)),4,0,6.28); ctx2.fill();
    i2.innerHTML = `g(${l.toFixed(2)}) = ${g(l).toFixed(2)}`;
  }
  lamS.oninput=render; render();
})();
</script>
</body>
</html>
